{% extends 'client.html.twig' %}

{% block title %}{{ post.titre }}{% endblock %}

{% block body %}
    <div class="container mt-4" style="max-width: 800px;">
        
        <div class="d-flex justify-content-between mb-3">
            <a href="{{ path('post_list') }}" class="btn btn-secondary">‚¨Ö Retour</a>
            {% if post.auteur == app.user %}
                <a href="{{ path('post_edit', { 'id': post.id }) }}" class="btn btn-primary">‚úè Modifier</a>
                <form action="{{ path('post_delete', { 'id': post.id }) }}" method="post" onsubmit="return confirm('Voulez-vous vraiment supprimer ce post ?');" class="d-inline-block">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-trash"></i>
                    </button>
                </form>
            {% endif %}
        </div>

        <div class="post-card shadow-sm pt-1 bg-white rounded">
            <p class="text-muted"><strong>Post√© par </strong></p>
            <small class="text-muted mb-1">üïí Publi√© le {{ post.date|date('d/m/Y H:i') }}</small>
            <h2 class="text-primary">{{ post.titre }}</h2>
            <p class="text-muted">{{ post.contenu }}</p>
            {% if post.image %}
                <div class="text-center mb-3">
                    <img src="{{ asset('uploads/posts/' ~ post.image) }}" alt="Image du post" class="img-fluid img-custom rounded">
                </div>
            {% endif %}

            <div class="mt-3 d-flex gap-3 align-items-center">
                <button class="btn btn-outline-success btn-sm d-flex align-items-center like-btn">
                    <i class="fas fa-thumbs-up me-2"></i> 
                    <span>3054</span>
                </button>
                <button class="btn btn-outline-danger btn-sm d-flex align-items-center dislike-btn">
                    <i class="fas fa-thumbs-down me-2"></i>
                    <span>152</span>
                </button>
            </div>
        </div>

        <!-- Section des commentaires -->
      <h3>Commentaires</h3>
        <h3>Ajouter un commentaire</h3>
        <form action="{{ path('post_view', { 'id': post.id }) }}" method="post">
            {{ form_start(form) }}
            {{ form_widget(form) }}
            <button type="submit" class="btn btn-success mt-2">Commenter</button>
            {{ form_end(form) }}
        </form>

        {% for commentaire in post.commentaires %}
            <div class="comment-card p-3 mb-2 bg-light rounded">
                <p>{{ commentaire.contenu }}</p>
                <small class="text-muted">Publi√© le {{ commentaire.date|date('d/m/Y H:i') }}</small>
            </div>
        {% else %}
            <p>Aucun commentaire pour le moment.</p>
        {% endfor %}

     

    </div>

    <style>
        .post-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            padding: 15px;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .btn-outline-success, .btn-outline-danger, .btn-outline-primary {
            transition: all 0.3s ease;
            border-width: 2px;
        }

        .btn-outline-success:hover {
            background-color: #28a745;
            color: white;
            box-shadow: 0 4px 10px rgba(40,167,69,0.3);
        }

        .btn-outline-danger:hover {
            background-color: #dc3545;
            color: white;
            box-shadow: 0 4px 10px rgba(220,53,69,0.3);
        }

        .btn-outline-primary:hover {
            background-color: #007bff;
            color: white;
            box-shadow: 0 4px 10px rgba(0,123,255,0.3);
        }

        .gap-3 {
            gap: 20px;
        }

        .img-custom {
            max-height: 400px;
            object-fit: cover;
            border-radius: 10px;
        }

        .like-btn, .dislike-btn {
            border-radius: 30px;
            padding: 8px 20px;
        }

        .like-btn:hover, .dislike-btn:hover {
            transform: scale(1.1);
        }

        .comments-section {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .comment-card {
            border-left: 4px solid #007bff;
            padding-left: 10px;
        }

        .comment-form textarea {
            resize: none;
        }
        .comment-card {
            border-left: 4px solid #28a745;
            padding: 10px;
            background: #f8f9fa;
        }
    </style>
{% endblock %}
